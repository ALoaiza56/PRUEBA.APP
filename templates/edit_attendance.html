{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <nav class="sidebar">
        <div class="logo">
            <img src="{{ url_for('static', filename='images/logoAM.png') }}" alt="Logo AM"
                style="max-width: 100px; margin-bottom: 10px;">
            <h2>SchoolApp</h2>
        </div>
        <ul class="nav-links">
            <li class="active">
                <a href="{{ url_for('dashboard') }}#asistencia">Asistencia</a>
            </li>
            <li data-tab="asistencia-rapida">
                <a href="{{ url_for('dashboard') }}#asistencia-rapida">Asistencia Rápida</a>
            </li>
            <li>
                <a href="{{ url_for('dashboard') }}#estudiantes">Estudiantes</a>
            </li>
            {% if current_user.role == 'admin' %}
            <li>
                <a href="{{ url_for('dashboard') }}#profesores">Profesores</a>
            </li>
            <li>
                <a href="{{ url_for('dashboard') }}#fechas">Fechas</a>
            </li>
            {% endif %}
        </ul>
        <div class="user-info">
            <p>{{ current_user.username }}</p>
            <a href="{{ url_for('logout') }}" class="btn-logout">Cerrar Sesión</a>
        </div>
    </nav>

    <main class="main-content">
        <header>
            <h1 id="page-title">Editar Asistencia</h1>
        </header>

        <section class="tab-content active">
            <div class="card">
                <h3>Editar Registro de Asistencia</h3>
                <p style="margin-bottom: 1.5rem; color: #666;">
                    <strong>Fecha:</strong> {{ attendance.school_date.date }} - {{ attendance.school_date.shift }}<br>
                    <strong>Estudiante:</strong> {{ attendance.student.name }}
                </p>

                <form action="{{ url_for('edit_attendance', id=attendance.id) }}" method="POST" class="add-form"
                    style="display: flex; flex-direction: column; gap: 1rem; max-width: 500px;">

                    <div class="input-group">
                        <label>Estado:</label>
                        <select name="status" required>
                            <option value="Presente" {% if attendance.status=='Presente' %}selected{% endif %}>Presente
                            </option>
                            <option value="Ausente" {% if attendance.status=='Ausente' %}selected{% endif %}>Ausente
                            </option>
                            <option value="Tarde" {% if attendance.status=='Tarde' %}selected{% endif %}>Tarde</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Comentario:</label>
                        <input type="text" name="comment" value="{{ attendance.comment or '' }}"
                            placeholder="Añadir un comentario...">
                    </div>

                    <div style="margin-top: 2rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <button type="submit" class="btn-primary">Guardar</button>
                        <a href="{{ url_for('dashboard') }}#asistencia" class="btn-secondary">Cancelar</a>
                    </div>
                </form>
            </div>
        </section>
    </main>
</div>
{% endblock %}